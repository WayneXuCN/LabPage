---
layout: default
---
<div class="post">
  <div class="header-bar">
    <h1><i class="fa-solid fa-sm"></i> {{ page.title }}</h1>
    <h2>{{ page.description }}</h2>
  </div>

  {% assign posts_by_year = site.posts | group_by_exp: 'post', "post.date | date: '%Y'" %}
  {% assign total_posts = site.posts | size %}

  <!-- Calculate first post date -->
  {% assign sorted_posts = site.posts | sort: 'date' %}
  {% assign first_post = sorted_posts | first %}
  {% assign first_post_date = first_post.date | date: '%Y-%m-%d' %}

  <!-- Calculate total word count (estimated) -->
  {% assign total_words = 0 %}
  {% for post in site.posts %}
    {% assign post_words = post.content | strip_html | number_of_words %}
    {% assign total_words = total_words | plus: post_words %}
  {% endfor %}

  <!-- Calculate unique tags count -->
  {% assign all_tags = '' | split: ',' %}
  {% for post in site.posts %}
    {% for tag in post.tags %}
      {% unless all_tags contains tag %}
        {% assign all_tags = all_tags | push: tag %}
      {% endunless %}
    {% endfor %}
  {% endfor %}
  {% assign total_tags = all_tags | size %}

  <div class="archive-summary">
    <p class="archive-intro">{{ site.data[site.active_lang].strings.archive_timeline.intro | replace: '%DATE%', first_post_date }}</p>
    <div class="stats-container">
      <div class="stat-box">
        <div class="stat-number">
          <span class="number">{{ total_posts }}</span>
          <span class="unit">{{ site.data[site.active_lang].strings.archive_timeline.posts_unit }}</span>
        </div>
        <div class="stat-label"><i class="fa-solid fa-file-text"></i> {{ site.data[site.active_lang].strings.archive_timeline.posts_label }}</div>
      </div>
      <div class="stat-box">
        {% assign words_in_wan = total_words | divided_by: 10000.0 %}
        {% assign is_cjk = false %}
        {% if site.active_lang == 'zh_CN' or site.active_lang == 'ja_JP' %}
          {% assign is_cjk = true %}
        {% endif %}
        {% if total_words >= 10000 and is_cjk %}
          <div class="stat-number">
            <span class="number">{{ words_in_wan | round: 1 }}</span>
            <span class="unit">{{ site.data[site.active_lang].strings.archive_timeline.words_unit_wan }}</span>
          </div>
        {% else %}
          {% assign words_in_thousand = total_words | divided_by: 1000.0 %}
          <div class="stat-number">
            <span class="number">{{ words_in_thousand | round: 1 }}</span>
            <span class="unit">{{ site.data[site.active_lang].strings.archive_timeline.words_unit_thousand }}</span>
          </div>
        {% endif %}
        <div class="stat-label"><i class="fa-solid fa-pen-nib"></i> {{ site.data[site.active_lang].strings.archive_timeline.words_label }}</div>
      </div>
      <div class="stat-box">
        <div class="stat-number">
          <span class="number">{{ total_tags }}</span>
          <span class="unit">{{ site.data[site.active_lang].strings.archive_timeline.tags_unit }}</span>
        </div>
        <div class="stat-label"><i class="fa-solid fa-tags"></i> {{ site.data[site.active_lang].strings.archive_timeline.tags_label }}</div>
      </div>
    </div>
  </div>

  <div class="archive-content">
    {% for year_group in posts_by_year %}
      {% assign year = year_group.name %}
      {% assign posts = year_group.items %}

      <div class="year-section">
        <h3 class="archive-year-header">
          <i class="fa-solid fa-calendar fa-sm"></i>
          <a href="{{ year | prepend: '/blog/' | relative_url }}">{{ year }}</a>
          <span class="post-count">({{ posts | size }} posts)</span>
        </h3>

        <div class="archive-posts">
          <div class="table-responsive">
            <table class="table table-sm table-borderless">
              {% for post in posts %}
                <tr class="archive-post-row">
                  <td class="title-column">
                    <div class="post-title-wrapper">
                      {% if post.redirect == blank %}
                        <a class="post-link" href="{{ post.url | relative_url }}">{{ post.title }}</a>
                      {% elsif post.redirect contains '://' %}
                        <a class="post-link" href="{{ post.redirect }}" target="_blank">{{ post.title }}</a>
                        <svg width="1rem" height="1rem" viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg" style="vertical-align: baseline;">
                          <path d="M17 13.5v6H5v-12h6m3-3h6v6m0-6-9 9" class="icon_svg-stroke" stroke="#999" stroke-width="1.5" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path>
                        </svg>
                      {% else %}
                        <a class="post-link" href="{{ post.redirect | relative_url }}">{{ post.title }}</a>
                      {% endif %}
                    </div>

                    <div class="post-meta-line">
                      <span class="post-date">
                        <i class="fa-solid fa-calendar fa-xs"></i>
                        {{ post.date | date: '%b %d, %Y' }}
                      </span>

                      {% if post.description %}
                        <span class="post-description">{{ post.description }}</span>
                      {% endif %}
                    </div>
                  </td>
                  <td class="tags-column">
                    {% assign tags = post.tags | join: '' %}
                    {% assign categories = post.categories | join: '' %}

                    {% if categories != '' or tags != '' %}
                      <div class="post-tags">
                        {% if categories != '' %}
                          {% for category in post.categories %}
                            <a href="{{ category | slugify | prepend: '/blog/category/' | relative_url }}" class="tag-link">
                              <i class="fa-solid fa-tag fa-xs"></i> {{ category }}
                            </a>
                          {% endfor %}
                        {% endif %}

                        {% if tags != '' %}
                          {% if categories != '' %}
                            <span class="tag-separator">&middot;</span>
                          {% endif %}
                          {% for tag in post.tags %}
                            <a href="{{ tag | slugify | prepend: '/blog/tag/' | relative_url }}" class="tag-link">
                              <i class="fa-solid fa-hashtag fa-xs"></i> {{ tag }}
                            </a>
                            {% unless forloop.last %}
                              <span class="tag-separator">&nbsp;</span>
                            {% endunless %}
                          {% endfor %}
                        {% endif %}
                      </div>
                    {% endif %}
                  </td>
                </tr>
              {% endfor %}
            </table>
          </div>
        </div>
      </div>

      {% unless forloop.last %}
        <hr class="year-divider">
      {% endunless %}
    {% endfor %}
  </div>
</div>
