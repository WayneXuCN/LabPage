---
layout: post
title: Word Typesetting Notes
date: 2024-06-23 21:35:00
last_updated: 2024-06-23 21:35:00
description: Common Word typesetting tips and macro tools
tags: Word Typesetting
categories: Writing
featured: false
giscus_comments: true
related_posts: true
toc:
  sidebar: right
---

## Word Macros

### Cross-reference Color

Automatically formats cross-references in Word, as well as Endnote/Zotero cross-references, with the default color set to blue.

```basic
Sub CitingColor()
    For i = 1 To ActiveDocument.Fields.Count 'Loop through all fields in the document
        If Left(ActiveDocument.Fields(i).Code, 4) = " REF" Or Left(ActiveDocument.Fields(i).Code, 14) = " ADDIN EN.CITE" Or Left(ActiveDocument.Fields(i).Code, 31) = " ADDIN ZOTERO_ITEM CSL_CITATION" Then 'The field code for Word's built-in cross-reference starts with " REF" (note the space), EndNote's reference field code starts with " ADDIN EN.CITE", and Zotero's reference field code starts with " ADDIN ZOTERO_ITEM CSL_CITATION". Add other types as needed.
        ActiveDocument.Fields(i).Select 'Select these types of fields
        Selection.Font.Color = RGB(31, 77, 160) 'Set font color
        End If
    Next
End Sub
```

### Mathtype Uniform Scaling

Used to fix inconsistent heights of Mathtype equations after updating, by reapplying uniform scaling.

```basic
Sub EqMathtype_100()
'
' EqMathtype_100 Macro
''
Dim i As Integer
Dim total As Integer
total = ActiveDocument.InlineShapes.Count
i = 0
For Each s In ActiveDocument.InlineShapes
i = i + 1
On Error Resume Next
Application.StatusBar = "Progress: " & i & " of " & total
If s.Type = msoAutoShape Then
If s.OLEFormat.ClassType = "Equation.DSMT4" Then
With s
.ScaleHeight = 100
.ScaleWidth = 100
End With
End If
End If
Next
End Sub
```

<footer lang="en" style="
  background-color: #f8f9fa;
  color: #6c757d;
  font-size: 0.85rem;
  line-height: 1.5;
  padding: 1rem 1.5rem;
  margin-top: 2rem;
  border-top: 1px solid #e9ecef;
  text-align: center;
">
  <p style="margin: 0; word-break: break-word;">
    This page was automatically translated by generative AI and may contain inaccuracies or incomplete information.
    <a href="mailto:wenjie.xu.cn@outlook.com" style="
      color: #007bff;
      text-decoration: none;
    ">Feedback is welcome</a> to help us improve.
  </p>
</footer>
