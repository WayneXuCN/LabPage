---
layout: post
title: Windows-Systemkonfigurationsnotizen
date: 2022-11-21 08:15:00
last_updated: 2024-09-12 15:17:34
description: Notizen zur Softwarekonfiguration und Fehlerbehebung unter Windows
tags: Windows Configuration
categories: Tools
featured: false
giscus_comments: false
related_posts: true
toc:
  sidebar: right
---

Hier dokumentiere ich meine Windows-Systemkonfigurationen und häufige Lösungen für typische Fehler, um nicht jedes Mal erneut suchen zu müssen。

## Systemkonfiguration

### 1. Rechtsklick-Menü

Desktop-Kontextmenü bereinigen

```text
Computer\HKEY_CLASSES_ROOT\Directory\Background\shell
```

Kontextmenü für Ordner bereinigen

```text
Computer\HKEY_CLASSES_ROOT\Directory\shell
Computer\HKEY_CLASSES_ROOT\Directory\shellex\ContextMenuHandlers
Computer\HKEY_CLASSES_ROOT\Folder\shell
Computer\HKEY_CLASSES_ROOT\Folder\shellex\ContextMenuHandlers
```

Kontextmenü für Dateien konfigurieren

```text
Computer\HKEY_CLASSES_ROOT\*\shellex\ContextMenuHandlers
```

### 2. Remote Desktop

Bei Anmeldung mit Microsoft-Konto als Anmeldedaten wird oft ein falsches Passwort gemeldet。Das kann daran liegen, dass das Passwort nach einer Änderung nicht aktualisiert wurde。Mit folgendem Befehl kann das Passwort aktualisiert werden：

```powershell
runas /u:MicrosoftAccount\wenjie.xu.cn@outlook.com winver
```

### 2. Funktionsoberfläche

Virtuellen Speicher auf ein anderes Laufwerk als das Systemlaufwerk legen (Fehlerbehebung für „Beim Starten des Computers ist ein Problem mit der Auslagerungsdatei aufgetreten, Windows hat eine temporäre Auslagerungsdatei erstellt“）：

```powershell
reg add "HKLM\System\CurrentControlSet\Control\Session Manager\Memory Management" /v PagefileOnOsVolume /t REG_DWORD /d 0 /f
```

Jedes Explorer-Fenster als eigenen Prozess ausführen, um die Stabilität zu erhöhen：

```powershell
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v SeparateProcess /t REG_DWORD /d 1 /f
```

Treiber und Kernel-Code nicht in den virtuellen Speicher auslagern (kann Stabilitätsprobleme beheben）：

```powershell
reg add "HKLM\System\CurrentControlSet\Control\Session Manager\Memory Management" /v DisablePagingExecutive /t REG_D
```

Bei fehlerhafter Skalierung der Schriftarten auf Desktop/Explorer，kann die Skalierung per Registry zurückgesetzt werden：

```powershell
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Control Panel\Desktop\WindowMetrics]
"IconTitleWrap"="1"
"Shell Icon Size"="32"
"BorderWidth"="-15"
"CaptionFont"=hex:f4,ff,ff,ff,00,00,00,00,00,00,00,00,00,00,00,00,90,01,00,00,\
  00,00,00,01,00,00,05,00,53,00,65,00,67,00,6f,00,65,00,20,00,55,00,49,00,00,\
  00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,\
  00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00
"CaptionHeight"="-330"
"CaptionWidth"="-330"
"IconFont"=hex:f4,ff,ff,ff,00,00,00,00,00,00,00,00,00,00,00,00,90,01,00,00,00,\
  00,00,01,00,00,05,00,53,00,65,00,67,00,6f,00,65,00,20,00,55,00,49,00,00,00,\
  00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,\
  00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00
"MenuFont"=hex:f4,ff,ff,ff,00,00,00,00,00,00,00,00,00,00,00,00,90,01,00,00,00,\
  00,00,01,00,00,05,00,53,00,65,00,67,00,6f,00,65,00,20,00,55,00,49,00,00,00,\
  00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,\
  00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00
"MenuHeight"="-285"
"MenuWidth"="-285"
"MessageFont"=hex:f4,ff,ff,ff,00,00,00,00,00,00,00,00,00,00,00,00,90,01,00,00,\
  00,00,00,01,00,00,05,00,53,00,65,00,67,00,6f,00,65,00,20,00,55,00,49,00,00,\
  00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,\
  00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00
"ScrollHeight"="-255"
"ScrollWidth"="-255"
"SmCaptionFont"=hex:f4,ff,ff,ff,00,00,00,00,00,00,00,00,00,00,00,00,90,01,00,\
  00,00,00,00,01,00,00,05,00,53,00,65,00,67,00,6f,00,65,00,20,00,55,00,49,00,\
  00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,\
  00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00
"SmCaptionHeight"="-330"
"SmCaptionWidth"="-330"
"StatusFont"=hex:f4,ff,ff,ff,00,00,00,00,00,00,00,00,00,00,00,00,90,01,00,00,\
  00,00,00,01,00,00,05,00,53,00,65,00,67,00,6f,00,65,00,20,00,55,00,49,00,00,\
  00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,\
  00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00
"AppliedDPI"=dword:00000060
"PaddedBorderWidth"="-60"
"IconSpacing"="-1125"
"IconVerticalSpacing"="-1125"
"MinAnimate"="0"
```

## Entwicklerkonfiguration

### 1. Scoop Paketmanager

[Scoop](https://scoop.sh/) ist mein bevorzugter Paketmanager unter Windows, mit dem sich Software bequem über die Kommandozeile installieren lässt。Vorteile：

- Keine UAC-Popups
- Verhindert PATH-Verschmutzung durch viele Programme
- Keine unerwarteten Nebeneffekte bei Installation/Deinstallation
- Automatische Abhängigkeitsverwaltung
- Führt alle nötigen Einrichtungsschritte automatisch aus

Scoop speichert mehrere Versionen einer Anwendung in eigenen Ordnern, sodass man einfach wechseln oder zurückrollen kann。Im Explorer sieht man z.B. unter `C:\Users\Xu\scoop\apps\oh-my-posh` mehrere nach Version benannte Unterordner。Die aktuelle Version ist im `current`-Verzeichnis verlinkt。Alte Versionen können manuell gelöscht werden oder automatisch mit：

```bash
scoop cleanup oh-my-posh
# Alle alten Versionen bereinigen
scoop cleanup *
# Installationspaket-Cache löschen
scoop cache rm *
```

Installierte Programme mit scoop：

```bash
Name                   Version            Source Updated             Info
----                   -------            ------ -------             ----
7zip                   24.09              main   2024-12-02 16:34:26
aria2                  1.37.0-1           main   2024-11-11 21:58:04
btop                   1.0.4              main   2024-07-17 21:29:16
btop-lhm               1.0.4              main   2024-07-17 21:29:25
draw.io                25.0.2             extras 2024-12-05 15:24:34
everything             1.4.1.1026         extras 2024-12-04 14:25:38
fastfetch              2.33.0             main   2024-12-28 23:17:29
fd                     10.2.0             main   2024-12-22 12:47:35
ffmpeg                 7.1                main   2024-10-20 18:21:52
fzf                    0.57.0             main   2024-12-22 12:47:39
geekuninstaller        1.5.2.165          extras 2024-12-03 16:21:50
gh                     2.64.0             main   2024-12-22 12:57:21
ghostscript            10.04.0            main   2024-12-22 12:49:34
git                    2.47.1             main   2024-12-02 16:46:01
imagemagick            7.1.1-43           main   2024-12-25 22:26:47
innounp                1.76               main   2024-11-14 10:58:02
jid                    0.7.6              main   2024-12-22 12:49:50
jq                     1.7.1              main   2024-12-22 12:47:28
mingw                  14.2.0-rt_v12-rev0 main   2024-12-05 15:37:08
mongodb                8.0.4              main   2024-12-08 12:22:01
mongodb-compass        1.45.0             extras 2024-12-05 15:24:52
mongodb-database-tools 100.10.0           main   2024-12-02 17:10:50
mongosh                2.3.7              extras 2024-12-22 12:57:28
motrix                 1.8.19             extras 2024-12-02 17:45:13
nodejs-lts             22.12.0            main   2024-12-05 15:25:03
notepad3               6.24.1221.1        extras 2024-12-22 12:59:44
office-tool-plus       10.19.8.0          extras 2024-12-22 12:59:49
oh-my-posh             24.17.1            main   2024-12-25 22:26:58
openjdk21              21.0.2-13          java   2024-12-05 15:46:33
pandoc                 3.6.1              main   2024-12-25 22:27:12
picgo                  2.3.1              extras 2024-12-02 17:32:48
pipx                   1.7.1              main   2024-12-13 20:38:34
pnpm                   9.15.2             main   2024-12-28 23:17:37
poppler                24.08.0-0          main   2024-12-22 12:47:32
r                      4.4.2              main   2024-12-02 16:39:04
registry-finder        2.59.0.0           extras 2024-12-04 14:15:35
ripgrep                14.1.1             main   2024-12-22 12:47:37
rstudio                2024.12.0-467      extras 2024-12-22 13:00:34
rtools                 4.4.6335.6327      main   2024-12-02 14:16:57
sudo                   0.2020.01.26       main   2024-09-30 13:16:29
switchhosts            4.2.0.6119         extras 2024-12-02 17:38:16
texstudio              4.8.5              extras 2024-12-14 16:06:48
thorium                128.0.6613.189     extras 2024-12-02 17:36:29
typst                  0.12.0             main   2024-12-05 15:34:13
vcredist2022           14.42.34433.0      extras 2024-12-02 16:56:57
wixtoolset             5.0.2              main   2024-11-14 10:57:52
zoxide                 0.9.6              main   2024-12-22 12:47:42
```

### 2. Systemschriftarten

- Powershell: 'CaskaydiaMonoNerdFontMono'
- VS Code: 'CaskaydiaMonoNerdFontMono' (Englisch), 'LXGW WenKai Mono' (Chinesisch)
- Office Word: 'latinmodern-math' (für mathematische Formeln）

### 3. Node.js

#### Registry-Manager nrm

- nrm ist ein npm registry manager, mit dem man verschiedene Registrys einfach verwalten kann。Grundlegende Befehle：

```bash
# nrm installieren
npm install nrm -g
# Alle Registrys anzeigen
nrm ls
# Neue Registry hinzufügen
nrm add <registry-name> <registry-url>
# Registry entfernen
nrm del <registry-name>
# Aktive Registry wechseln
nrm use <registry-name>
# Geschwindigkeit aller Registrys testen
nrm test
```

### 3. MongoDB

#### Installation

Mit scoop MongoDB und Tools installieren：

```bash
scoop bucket add main
scoop install main/mongodb
scoop install main/mongodb-database-tools

scoop bucket add extras
scoop install extras/mongosh
scoop install extras/mongodb-compass
```

#### Konfiguration

MongoDB, das mit Scoop installiert wurde, ist standardmäßig kein Windows-Dienst, kann aber manuell als Dienst eingerichtet werden。

Installationspfad prüfen：

```bash
scoop prefix mongodb
```

Der mongod shim nutzt `$dir\bin\mongod.cfg` als Standardkonfiguration。Für andere Konfigurationsdateien：

`$dir\bin\mongod.exe --config NEW_CONFIG_FILE`

Vor dem Start müssen ggf. `data\db` und `data\log` angelegt werden (Pfad in `mongod.cfg`）：

```bash
<PFAD>\bin\mongod.exe --dbpath "<PFAD>\data\db" --logpath "<PFAD>\data\log\mongo.log" --logappend
```

In neuem Terminal prüfen：

```bash
mongosh
```

MongoDB als Windows-Dienst registrieren：

```bash
sc.exe create MongoDB binPath= "<PFAD>\bin\mongod.exe --service --config <PFAD>\mongod.cfg" DisplayName= "MongoDB" start= "auto"
```

- `<PFAD>`：Scoop-Installationspfad von MongoDB。
- `--service`：Dienstmodus。
- `--config`：Pfad zur Konfigurationsdatei (optional）。

Dienst starten, damit MongoDB beim Systemstart automatisch läuft：

```bash
net start MongoDB
```

<footer lang="de" style="
  background-color: #f8f9fa;
  color: #6c757d;
  font-size: 0.85rem;
  line-height: 1.5;
  padding: 1rem 1.5rem;
  margin-top: 2rem;
  border-top: 1px solid #e9ecef;
  text-align: center;
">
  <p style="margin: 0; word-break: break-word;">
    Diese Seite wurde automatisch von generativer KI übersetzt und kann Ungenauigkeiten oder unvollständige Informationen enthalten.
    <a href="mailto:wenjie.xu.cn@outlook.com" style="
      color: #007bff;
      text-decoration: none;
    ">Feedback ist willkommen</a>, um uns bei der Verbesserung zu helfen.
  </p>
</footer>
